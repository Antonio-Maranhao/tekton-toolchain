apiVersion: tekton.dev/v1alpha1
kind: TriggerTemplate
metadata:
  name: theTemplateTrigger
spec:
#  params:
#    - name: repository
#      description: The git repo
#    - name: apikey
#      description: the ibmcloud api key
#    - name: registryNamespace
#      description: the ibmcloud registry namespace
#    - name: registryRegion
#      description: the ibmcloud registry region
#      default: us-south
#    - name: cluster
#      description: The IBM Cloud Kubernetes cluster name
#    - name: clusterRegion
#      description: The IBM Cloud Kubernetes cluster region
#      default: us-south
#    - name: clusterNamespace
#      description: The Kubernetes cluster namespace
#      default: prod
  resourcetemplates:
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineRun
      metadata:
        name: pipelinerun-$(uid)
      spec:
        pipelineRef:
            name: pipeline
#        params:
#        - name: pipeline-pvc
#          value: pipelinerun-$(uid)-pvc
#        - name: repository
#          value: $(params.repository)
#        - name: apikey
#          value: $(params.apikey)
#        - name: registryNamespace
#          value: $(params.registryNamespace)
#        - name: registryRegion
#          value: $(params.registryRegion)
#        - name: cluster
#          value: $(params.cluster)
#        - name: clusterRegion
#          value: $(params.clusterRegion)
#        - name: clusterNamespace
#          value: $(params.clusterNamespace)
---
apiVersion: tekton.dev/v1alpha1
kind: TriggerBinding
metadata:
  name: binding
spec:
  params:
    - name: repository
      value: "https://github.com/powellquiring/tekton"
---
apiVersion: tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: listener
spec:
  triggers:
    - binding:
        name: binding
      template:
        name: theTemplateTrigger
---
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: echo-hello-world
spec:
  steps:
    - name: echo
      image: ubuntu
      command:
        - echo
      args:
        - "8 hello world tekton"
---
apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: echo-hello-world-task-run
spec:
  taskRef:
    name: echo-hello-world
---
apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: pipeline
spec:
  tasks:
    - name: pipeline-echo-hello-world
      taskRef:
        name: echo-hello-world
